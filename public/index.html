<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üè†‚Äç‚¨õ Raven - –ü—Ä–æ—Å—Ç–æ–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/socket.io-client@4/dist/socket.io.js"></script>
    <script src="htt                    // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
                    if (message.username !== currentUser) {
                        console.log('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç:', message.username);
                    }npkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        :root {
            /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ */
            --bg-primary: #f0f2f5;
            --bg-secondary: white;
            --bg-tertiary: #f5f5f5;
            --text-primary: #333;
            --text-secondary: #666;
            --text-inverse: white;
            --border-color: #e0e0e0;
            --accent-color: #2196F3;
            --message-bg-my: #2196F3;
            --message-bg-other: #e3f2fd;
            --hover-bg: #f0f0f0;
            --shadow: rgba(0,0,0,0.1);
        }

        [data-theme="dark"] {
            /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ */
            --bg-primary: #1a1a1a;
            --bg-secondary: #2d2d2d;
            --bg-tertiary: #3d3d3d;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --text-inverse: #ffffff;
            --border-color: #404040;
            --accent-color: #64b5f6;
            --message-bg-my: #1976d2;
            --message-bg-other: #424242;
            --hover-bg: #505050;
            --shadow: rgba(0,0,0,0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: var(--bg-primary);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .app-container {
            width: 100%;
            max-width: 800px;
            height: 90vh;
            background: var(--bg-secondary);
            border-radius: 20px;
            box-shadow: 0 20px 40px var(--shadow);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
        }

        .header {
            background: var(--accent-color);
            color: var(--text-inverse);
            padding: 20px;
            box-shadow: 0 2px 10px var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-info h1 {
            margin: 0;
            font-size: 24px;
        }

        .header-info div {
            font-size: 14px;
            opacity: 0.9;
        }

        .theme-toggle {
            background: rgba(255,255,255,0.2);
            border: none;
            color: var(--text-inverse);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .theme-toggle:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .status {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            padding: 10px 20px;
            text-align: center;
            font-size: 14px;
            border-bottom: 1px solid var(--border-color);
        }

        .messages-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: var(--bg-secondary);
        }

        .message {
            margin-bottom: 15px;
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            position: relative;
            transition: all 0.3s ease;
        }

        .message.my {
            background: var(--message-bg-my);
            color: var(--text-inverse);
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .message.other {
            background: var(--message-bg-other);
            color: var(--text-primary);
            margin-right: auto;
            border-bottom-left-radius: 4px;
        }

        .message-username {
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
            opacity: 0.7;
        }

        .message-text {
            font-size: 16px;
            line-height: 1.4;
        }

        .message-time {
            font-size: 11px;
            opacity: 0.7;
            margin-top: 5px;
        }

        .input-container {
            padding: 20px;
            background: var(--bg-secondary);
            border-top: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .emoji-panel {
            background: var(--bg-tertiary);
            padding: 15px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-height: 150px;
            overflow-y: auto;
            animation: slideDown 0.2s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .emoji-button {
            font-size: 24px;
            padding: 8px;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.2s;
            user-select: none;
        }

        .emoji-button:hover {
            background: var(--hover-bg);
            transform: scale(1.2);
        }

        .input-row {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .emoji-toggle {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            border: 2px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-primary);
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .emoji-toggle:hover {
            background: var(--hover-bg);
            border-color: var(--accent-color);
            transform: scale(1.05);
        }

        .input-field {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.2s;
            background: var(--bg-secondary);
            color: var(--text-primary);
        }

        .input-field:focus {
            border-color: var(--accent-color);
        }

        .send-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            background: var(--accent-color);
            color: var(--text-inverse);
            font-size: 20px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .send-button:hover {
            background: #1976D2;
        }

        .send-button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .typing-indicator {
            padding: 10px 20px;
            font-style: italic;
            color: var(--text-secondary);
            background: var(--bg-tertiary);
            border-radius: 15px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .typing-animation {
            display: flex;
            gap: 3px;
        }

        .typing-animation span {
            width: 6px;
            height: 6px;
            background: var(--accent-color);
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .typing-animation span:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-animation span:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typingBounce {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ä–µ–∞–∫—Ü–∏–π */
        .reactions-container {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            margin-top: 5px;
        }

        .reaction-item {
            display: flex;
            align-items: center;
            background: #e3f2fd;
            border: none;
            border-radius: 12px;
            padding: 2px 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .reaction-item:hover {
            background: #bbdefb;
            transform: scale(1.05);
        }

        .reaction-emoji {
            margin-right: 2px;
        }

        .reaction-count {
            color: #666;
            font-weight: bold;
        }

        .reaction-buttons {
            display: flex;
            gap: 2px;
            margin-top: 5px;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .message:hover .reaction-buttons {
            opacity: 1;
        }

        .reaction-button {
            background: none;
            border: none;
            padding: 2px 4px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .reaction-button:hover {
            background: var(--hover-bg);
            transform: scale(1.2);
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .app-container {
                height: 100vh;
                border-radius: 0;
            }
            
            .message {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function MessengerApp() {
            const [currentUser, setCurrentUser] = useState('');
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [messages, setMessages] = useState([]);
            const [messageText, setMessageText] = useState('');
            const [userCount, setUserCount] = useState(0);
            const [isConnected, setIsConnected] = useState(false);
            const [typingUsers, setTypingUsers] = useState([]);
            const [showEmojiPanel, setShowEmojiPanel] = useState(false);
            const [messageReactions, setMessageReactions] = useState(new Map());
            const [isDarkTheme, setIsDarkTheme] = useState(false);
            
            const socketRef = useRef(null);
            const messagesEndRef = useRef(null);
            const typingTimeoutRef = useRef(null);

            // –°–ø–∏—Å–æ–∫ —ç–º–æ–¥–∑–∏
            const emojiList = [
                'üòÄ', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòÖ', 'üòÇ', 'ü§£', 'üòä', 'üòá',
                'üôÇ', 'üôÉ', 'üòâ', 'üòå', 'üòç', 'ü•∞', 'üòò', 'üòó', 'üòô', 'üòö',
                'üòã', 'üòõ', 'üòù', 'üòú', 'ü§™', 'ü§®', 'üßê', 'ü§ì', 'üòé', 'ü§©',
                'ü•≥', 'üòè', 'üòí', 'üòû', 'üòî', 'üòü', 'üòï', 'üôÅ', '‚òπÔ∏è', 'üò£',
                'üòñ', 'üò´', 'üò©', 'ü•∫', 'üò¢', 'üò≠', 'üò§', 'üò†', 'üò°', 'ü§¨',
                'ü§Ø', 'üò≥', 'ü•µ', 'ü•∂', 'üò±', 'üò®', 'üò∞', 'üò•', 'üòì', 'ü§ó',
                'ü§î', 'ü§≠', 'ü§´', 'ü§•', 'üò∂', 'üòê', 'üòë', 'üò¨', 'üôÑ', 'üòØ',
                'üò¶', 'üòß', 'üòÆ', 'üò≤', 'ü•±', 'üò¥', 'ü§§', 'üò™', 'üòµ', 'ü§ê',
                'ü•¥', 'ü§¢', 'ü§Æ', 'ü§ß', 'üò∑', 'ü§í', 'ü§ï', 'ü§ë', 'ü§†', 'üòà',
                'üëø', 'üëπ', 'üë∫', 'ü§°', 'üí©', 'üëª', 'üíÄ', '‚ò†Ô∏è', 'üëΩ', 'üëæ',
                'ü§ñ', 'üéÉ', 'üò∫', 'üò∏', 'üòπ', 'üòª', 'üòº', 'üòΩ', 'üôÄ', 'üòø',
                'üòæ', 'üëã', 'ü§ö', 'üñêÔ∏è', '‚úã', 'üññ', 'üëå', 'ü§è', '‚úåÔ∏è', 'ü§û',
                'ü§ü', 'ü§ò', 'ü§ô', 'üëà', 'üëâ', 'üëÜ', 'üñï', 'üëá', '‚òùÔ∏è', 'üëç',
                'üëé', 'üëä', '‚úä', 'ü§õ', 'ü§ú', 'üëè', 'üôå', 'üëê', 'ü§≤', 'ü§ù',
                'üôè', '‚úçÔ∏è', 'üíÖ', 'ü§≥', 'üí™', 'ü¶æ', 'ü¶ø', 'ü¶µ', 'ü¶∂', 'üëÇ'
            ];

            // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
            useEffect(() => {
                socketRef.current = io();

                socketRef.current.on('connect', () => {
                    console.log('–ü–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É');
                    setIsConnected(true);
                });

                socketRef.current.on('disconnect', () => {
                    console.log('–û—Ç–∫–ª—é—á–µ–Ω –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞');
                    setIsConnected(false);
                });

                socketRef.current.on('messageHistory', (history) => {
                    setMessages(history);
                });

                socketRef.current.on('newMessage', (message) => {
                    setMessages(prev => [...prev, message]);
                    
                    // –ü—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏
                    if (message.username !== currentUser) {
                        console.log('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç:', message.username);
                    }
                });

                socketRef.current.on('userJoined', (data) => {
                    setUserCount(data.userCount);
                });

                socketRef.current.on('userLeft', (data) => {
                    setUserCount(data.userCount);
                });

                socketRef.current.on('userTyping', (data) => {
                    setTypingUsers(prev => {
                        if (!prev.includes(data.username)) {
                            return [...prev, data.username];
                        }
                        return prev;
                    });
                });

                socketRef.current.on('userStoppedTyping', (data) => {
                    setTypingUsers(prev => prev.filter(user => user !== data.username));
                });

                socketRef.current.on('reactionUpdate', (data) => {
                    setMessageReactions(prev => {
                        const newReactions = new Map(prev);
                        newReactions.set(data.messageId, data.reactions);
                        return newReactions;
                    });
                });

                socketRef.current.on('joinSuccess', (data) => {
                    setUserCount(data.userCount);
                });

                return () => {
                    if (socketRef.current) {
                        socketRef.current.disconnect();
                    }
                };
            }, [currentUser]);

            // –ê–≤—Ç–æ–ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–µ–º—É —Å–æ–æ–±—â–µ–Ω–∏—é
            useEffect(() => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [messages]);

            // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–º–æ–π
            const toggleTheme = () => {
                const newTheme = !isDarkTheme;
                setIsDarkTheme(newTheme);
                document.documentElement.setAttribute('data-theme', newTheme ? 'dark' : 'light');
                localStorage.setItem('darkTheme', newTheme);
            };

            // –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–º—ã –∏–∑ localStorage –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
            useEffect(() => {
                const savedTheme = localStorage.getItem('darkTheme') === 'true';
                setIsDarkTheme(savedTheme);
                document.documentElement.setAttribute('data-theme', savedTheme ? 'dark' : 'light');
            }, []);

            const handleLogin = (username) => {
                if (username.trim()) {
                    setCurrentUser(username.trim());
                    setIsLoggedIn(true);
                    socketRef.current.emit('userJoin', username.trim());
                }
            };

            const sendMessage = () => {
                if (!messageText.trim() || !isConnected) return;

                const currentTime = new Date().toLocaleTimeString('ru-RU', {
                    hour: '2-digit',
                    minute: '2-digit'
                });

                socketRef.current.emit('sendMessage', {
                    username: currentUser,
                    text: messageText.trim(),
                    time: currentTime
                });
                setMessageText('');
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è
                socketRef.current.emit('stopTyping', { username: currentUser });
            };

            const handleInputChange = (e) => {
                setMessageText(e.target.value);
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Å–æ–±—ã—Ç–∏–µ –Ω–∞—á–∞–ª–∞ –ø–µ—á–∞—Ç–∏
                if (e.target.value.trim() && isConnected) {
                    socketRef.current.emit('typing', { username: currentUser });
                    
                    // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç–∞–π–º–µ—Ä
                    if (typingTimeoutRef.current) {
                        clearTimeout(typingTimeoutRef.current);
                    }
                    
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ–≤—ã–π —Ç–∞–π–º–µ—Ä –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–µ—á–∞—Ç–∏
                    typingTimeoutRef.current = setTimeout(() => {
                        socketRef.current.emit('stopTyping', { username: currentUser });
                    }, 1000); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É –±–µ–∑–¥–µ–π—Å—Ç–≤–∏—è
                } else {
                    // –ï—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—á–∞—Ç—å
                    socketRef.current.emit('stopTyping', { username: currentUser });
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    if (isLoggedIn) {
                        sendMessage();
                    } else {
                        handleLogin(e.target.value);
                    }
                }
            };

            // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç–º–æ–¥–∑–∏
            const toggleEmojiPanel = () => {
                setShowEmojiPanel(!showEmojiPanel);
            };

            const addReaction = (messageId, emoji) => {
                if (!isConnected) return;
                
                socketRef.current.emit('addReaction', {
                    messageId: messageId,
                    emoji: emoji,
                    username: currentUser
                });
            };

            const addEmoji = (emoji) => {
                setMessageText(prev => prev + emoji);
                setShowEmojiPanel(false); // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
            };

            if (!isLoggedIn) {
                return (
                    <div className="app-container">
                        <div className="header">
                            <div className="header-info">
                                <h1>üè†‚Äç‚¨õ Raven</h1>
                                <div>–ü—Ä–æ—Å—Ç–æ–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</div>
                            </div>
                            <button className="theme-toggle" onClick={toggleTheme}>
                                {isDarkTheme ? '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è' : 'üåô –¢–µ–º–Ω–∞—è'}
                            </button>
                        </div>
                        <div style={{ 
                            flex: 1, 
                            display: 'flex', 
                            flexDirection: 'column', 
                            justifyContent: 'center', 
                            alignItems: 'center',
                            padding: '40px'
                        }}>
                            <h2 style={{ marginBottom: '20px', textAlign: 'center' }}>
                                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!
                            </h2>
                            <p style={{ 
                                marginBottom: '30px', 
                                textAlign: 'center',
                                color: 'var(--text-secondary)',
                                lineHeight: '1.6'
                            }}>
                                –í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —á–∞—Ç
                            </p>
                            <input
                                type="text"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è..."
                                onKeyPress={handleKeyPress}
                                style={{
                                    padding: '15px 20px',
                                    fontSize: '16px',
                                    borderRadius: '25px',
                                    border: '2px solid var(--border-color)',
                                    outline: 'none',
                                    width: '100%',
                                    maxWidth: '300px',
                                    textAlign: 'center',
                                    background: 'var(--bg-secondary)',
                                    color: 'var(--text-primary)'
                                }}
                                autoFocus
                            />
                        </div>
                    </div>
                );
            }

            return (
                <div className="app-container">
                    <div className="header">
                        <div className="header-info">
                            <h1>üè†‚Äç‚¨õ Raven</h1>
                            <div>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {currentUser}!</div>
                        </div>
                        <button className="theme-toggle" onClick={toggleTheme}>
                            {isDarkTheme ? '‚òÄÔ∏è –°–≤–µ—Ç–ª–∞—è' : 'üåô –¢–µ–º–Ω–∞—è'}
                        </button>
                    </div>
                    
                    <div className="status">
                        {isConnected ? `üü¢ –û–Ω–ª–∞–π–Ω ‚Ä¢ ${userCount} —á–µ–ª–æ–≤–µ–∫` : 'üî¥ –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ...'}
                    </div>

                    <div className="messages-container">
                        {messages.map((message) => {
                            const reactions = messageReactions.get(message.id) || {};
                            const reactionEmojis = ['‚ù§Ô∏è', 'üëç', 'üòÇ', 'üò¢', 'üòÆ', 'üò°'];
                            
                            return (
                                <div
                                    key={message.id}
                                    className={`message ${message.username === currentUser ? 'my' : 'other'}`}
                                >
                                    {message.username !== currentUser && (
                                        <div className="message-username">{message.username}</div>
                                    )}
                                    <div className="message-text">{message.text}</div>
                                    <div className="message-time">{message.time}</div>
                                    
                                    {/* –ü–æ–∫–∞–∑ —Ä–µ–∞–∫—Ü–∏–π */}
                                    {Object.keys(reactions).length > 0 && (
                                        <div className="reactions-container">
                                            {Object.entries(reactions).map(([emoji, users]) => (
                                                <button
                                                    key={emoji}
                                                    className="reaction-item"
                                                    onClick={() => addReaction(message.id, emoji)}
                                                >
                                                    <span className="reaction-emoji">{emoji}</span>
                                                    <span className="reaction-count">{users.length}</span>
                                                </button>
                                            ))}
                                        </div>
                                    )}
                                    
                                    {/* –ö–Ω–æ–ø–∫–∏ —Ä–µ–∞–∫—Ü–∏–π */}
                                    <div className="reaction-buttons">
                                        {reactionEmojis.map((emoji) => (
                                            <button
                                                key={emoji}
                                                className="reaction-button"
                                                onClick={() => addReaction(message.id, emoji)}
                                                title={`–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é ${emoji}`}
                                            >
                                                {emoji}
                                            </button>
                                        ))}
                                    </div>
                                </div>
                            );
                        })}
                        
                        {/* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–µ—á–∞—Ç–∏ */}
                        {typingUsers.length > 0 && (
                            <div className="typing-indicator">
                                <span className="typing-dots">
                                    {typingUsers.length === 1 
                                        ? `${typingUsers[0]} –ø–µ—á–∞—Ç–∞–µ—Ç...` 
                                        : `${typingUsers.length} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–µ—á–∞—Ç–∞—é—Ç...`
                                    }
                                </span>
                                <div className="typing-animation">
                                    <span></span>
                                    <span></span>
                                    <span></span>
                                </div>
                            </div>
                        )}
                        
                        <div ref={messagesEndRef} />
                    </div>

                    <div className="input-container">
                        {/* –ü–∞–Ω–µ–ª—å —ç–º–æ–¥–∑–∏ */}
                        {showEmojiPanel && (
                            <div className="emoji-panel">
                                {emojiList.map((emoji, index) => (
                                    <span
                                        key={index}
                                        className="emoji-button"
                                        onClick={() => addEmoji(emoji)}
                                        title={emoji}
                                    >
                                        {emoji}
                                    </span>
                                ))}
                            </div>
                        )}
                        
                        {/* –°—Ç—Ä–æ–∫–∞ –≤–≤–æ–¥–∞ */}
                        <div className="input-row">
                            <button
                                className="emoji-toggle"
                                onClick={toggleEmojiPanel}
                                title="–≠–º–æ–¥–∑–∏"
                            >
                                üòÄ
                            </button>
                            
                            <input
                                type="text"
                                className="input-field"
                                placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                                value={messageText}
                                onChange={handleInputChange}
                                onKeyPress={handleKeyPress}
                                disabled={!isConnected}
                            />
                            
                            <button
                                className="send-button"
                                onClick={sendMessage}
                                disabled={!messageText.trim() || !isConnected}
                                title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å"
                            >
                                ‚û§
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<MessengerApp />, document.getElementById('root'));
    </script>
</body>
</html>